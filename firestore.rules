rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /confessions/{confession} {
      // Anyone can create a confession
      allow create: if true;
      
      // Only admins can read, update, or delete
      // Using a custom claim or just checking if auth is present and specific email if simple
      // For this requested implementation: "use custom claim isAdmin: true or an admins collection"
      // User asked for "Admin Login (Firebase Auth)" with Custom Claim or Admins collection.
      
      // OPTION 1: Simple check for authentication (if we assume only admins have accounts)
      // Since we are using email/password, and we haven't built a signup page for normal users,
      // effectively any authenticated user is an admin.
      allow read, update, delete: if request.auth != null;
    }
  }
}
